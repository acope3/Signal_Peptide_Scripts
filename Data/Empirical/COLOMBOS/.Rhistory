library(ribModel)
library(ribModel)
setwd("../../Results/Ecoli_K12_ncbi/Nosp_w_mp_cat/allUnique/chain2/run_1/R_objects/")
setwd("../")
getwd
getwd()
parameter <- loadParameterObject("R_objects//parameter.Rda")
trace <- parameter$getTraceObject()
a="A"
done.adapt<-TRUE
accept.trace <- trace$getCodonSpecificAcceptanceRateTraceForAA(a)
len <- length(accept.trace)
mean.acceptance <- mean(accept.trace[(len-len*0.1):len])
if (mean.acceptance < 0.1 || mean.acceptance > 0.44)
{
done.adapt <- FALSE
}
done.adapt
A
mean.acceptance
done.adapt<-TRUE
aa<-aminoAcids()
for(a in aa)
{
if (a=="M"||a=="X"||a=="W") next
accept.trace <- trace$getCodonSpecificAcceptanceRateTraceForAA(a)
len <- length(accept.trace)
mean.acceptance <- mean(accept.trace[(len-len*0.1):len])
if (mean.acceptance < 0.1 || mean.acceptance > 0.44)
{
done.adapt <- FALSE
}
#plot(accept.trace,main=paste0("Acceptace Rate for ",a),xlab="Samples",ylab="Acceptance Rate",type="l")
}
done.adapt
aa <- aminoAcids()
done.adapt <- TRUE
for(a in aa)
{
if (a=="M"||a=="X"||a=="W") next
accept.trace <- trace$getCodonSpecificAcceptanceRateTraceForAA(a)
len <- length(accept.trace)
mean.acceptance <- mean(accept.trace[(len-len*0.1):len])
if (mean.acceptance < 0.1 || mean.acceptance > 0.44) done.adapt <- FALSE
#plot(accept.trace,main=paste0("Acceptace Rate for ",a),xlab="Samples",ylab="Acceptance Rate",type="l")
}
done.adapt
setwd("/run/user/1000/gvfs/sftp:host=login.newton.utk.edu/data/home/acope3/Signal_Peptide_Project/Rscripts/Ecoli_K12_ncbi")
10000*200
50000*50
2e+06/50
40000*50
10 %% 0
library(ribModel)
setwd("/run/user/1000/gvfs/sftp:host=login.newton.utk.edu/data/home/acope3/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi")
setwd("~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi")
df <- read.table("mRNA_level_main_ht.csv",sep=",",header=T)
au <- read.table("trans_eff_main_ht.csv",sep=",",header=T)
au
mean.au <- mean(au[,2])
df[which(df[,2]==0),2] = mean.au
df <- read.table("mRNA_level_main_ht.csv",sep=",",header=T)
au[which(au[,2]==0),2] = mean.au
au
df <- read.table("mRNA_level_main_ht.csv",sep=",",header=T)
au <- read.table("trans_eff_main_ht.csv",sep=",",header=T)
mean.au <- mean(au[which(au[,2]!=0),2])
mean.au
au[which(au[,2]==0),2] = mean.au
au
df[,3] <- au[,2]
df[,4] <- df[,2] * df[,3]
phi <- read.table("../../../Results/Ecoli_K12_ncbi/Full_genome/main_ht/run_2/Parameter_est/gene_expression.txt",sep="",header=F)
plot(log10(df[,4]),ph[,2])
plot(log10(df[,4]),phi[,2])
plot(log10(df[,4]),phi[,1])
cor(log10(df[,4]),phi[,1])
cor(log10(df[which(df[,4]!=0),4]),phi[which(df[,4]!=0),1])
cor(log10(df[which(df[,4]!=0),4]),phi[which(df[,4]!=0),1],method="spearman")
mean.au <- mean(df[which(df[,2]!=0),2])
df[which(df[,2]==0),2] = mean.au
mean.au
df[,4] <- df[,2] * df[,3]
plot(log10(df[,4]),phi[,1])
View(df)
prot <- read.table("prot_synthesis_level.csv",sep=",",header=T)
plot(log10(prot[,2]),phi[,2])
plot(log10(prot[,2]),phi[,1])
cor(log10(prot[,2]),phi[,1])
cor(log10(prot[which(prot[,2]!=0),2]),phi[which(prot[,2]!=0),1])
cor(log10(prot[which(prot[,2]!=0),2]),phi[which(prot[,2]!=0),1],method="spearman")
cor(log10(prot[which(prot[,2]>10),2]),phi[which(prot[,2]>10),1],method="spearman")
cor(log10(prot[which(prot[,2]>10),2]),phi[which(prot[,2]>10),1])
prot <- read.table("prot_synthesis_level_no_m.csv",sep=",",header=T)
plot(log10(prot[,2]),phi[,1])
cor(log10(prot[which(prot[,2]>10),2]),phi[which(prot[,2]>10),1])
cor(log10(prot[which(prot[,2]!=0),2]),phi[which(prot[,2]!=0),1])
mean.syn <- mean(prot[,2])
prot[,3] <- prot[,2]/mean.syn
mean(prot[,3])
plot(prot[,2],10^phi[,1])
cor(prot[,2],10^phi[,1])
cor(prot[,2],10^phi[,1],method="spearman")
cor(prot[which(prot[,2]<1000),2],10^phi[which(prot[,2]<1000),1],method="spearman")
plot(prot[which(prot[,2]<1000),2],10^phi[which(prot[,2]<1000),1],method="spearman")
plot(prot[,3],10^phi[,1])
warnings()
plot(prot[,3],10^phi[,1])
cor(prot[,3],10^phi[,1])
cor(prot[which(prot[,3]<50),3],10^phi[which(prot[,3] < 50),1])
plot(prot[which(prot[,3]<50),3],10^phi[which(prot[,3] < 50),1])
plot(prot[which(prot[,3]<10),3],10^phi[which(prot[,3] < 10),1])
plot(prot[which(prot[,3]<2),3],10^phi[which(prot[,3] < 2),1])
df
mean.mrna <- mean(df[,2])
mean.mrna
mrna <- df[,2]/mean.mrna
range(mrna)
mrna
plot(mrna,10^phi[,1])
cor(mrna,10^phi[,1])
cor(mrna,10^phi[,1],method="spearman")
cor(mrna[1,3554],10^phi[[1,3554],1])
cor(mrna[1:3554,],10^phi[1:3554,1])
cor(mrna[1:3554],10^phi[1:3554,1])
cor(prot[1:3554,3],10^phi[1:3554,1])
setwd("~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2")
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
traceback()
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
traceback()
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
syth <- lapply(df[,2:23],function(i){i * df[,24]})
synth
syn
syth
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df <- cbind(df[,1],lapply(df[,2:23],function(i){i * df[,24]}))
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- lapply(df[,2:23],function(i){i * df[,24]})
df[,1]
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- apply(df[,2:23],function(i){i * df[,24]})
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- apply(df[,2:23],function(i){i * df[,24]})
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- sapply(df[,2:23],function(i){i * df[,24]})
df
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- cbind(df[,1],sapply(df[,2:23],function(i){i * df[,24]}))
df
df <- read.table("samples_1_6.csv",sep=",",header=T,stringsAsFactors = FALSE)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T,stringsAsFactors = FALSE)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- cbind(df[,1],sapply(df[,2:23],function(i){i * df[,24]}))
df
df <- read.table("samples_1_6.csv",sep=",",header=T,stringsAsFactors = FALSE)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T,stringsAsFactors = FALSE)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- cbind(df[,1],sapply(df[,2:23],function(i){i * df[,24]}))
df <- sapply(df[,2:23],as.numeric)
df
df <- read.table("samples_1_6.csv",sep=",",header=T,stringsAsFactors = FALSE)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T,stringsAsFactors = FALSE)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- cbind(df[,1],sapply(df[,2:23],function(i){as.numeric(i) * df[,24]}))
df
df <- read.table("samples_1_6.csv",sep=",",header=T,stringsAsFactors = FALSE)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T,stringsAsFactors = FALSE)
au <- read.table("../trans_eff_main_ht.csv",sep=",",header=T)
df <- merge(df,df.2,by="Gene")
df <- merge(df,au,by="Gene")
df<- sapply(df[,2:23],function(i){as.numeric(i) * df[,24]})
df
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
df <- read.table("samples_1_6.csv",sep=",",header=T)
df <- read.table("samples_7_22.csv",sep=",",header=T)
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
View(df)
View(df.2)
df.3 <- merge(df,df.2,by="Gene")
View(df.3)
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
View(phi)
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
debugSource('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
log10(df[x,i])
length(log10(df[x,i]))
debugSource('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
log10(df[x,i])
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.3 <- merge(df,df.2,by="Gene")
df[,2] == df.3[,2]
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.3 <- merge(df,df.2,by="Gene")
df[,2] == df.3[,2]
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.2$id <- 1:nrow(df.2)
df.3 <- merge(df,df.2,by="Gene")
df.3[order(df.2$id),]
phi <- read.table("../../..
)
""
"
df[,2] == df.3[,2]
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.2$id <- 1:nrow(df.2)
df.3 <- merge(df,df.2,by="Gene")
df.3[order(df.2$id),]
df[,2] == df.3[,2]
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.2$id <- 1:nrow(df.2)
df.3 <- merge(df,df.2,by="Gene")
df.4<-df.3[order(df.2$id),]
df[,2] == df.4[,2]
View(df.4)
library(plyr)
df <- read.table("samples_1_6.csv",sep=",",header=T)
df.2 <- read.table("samples_7_22.csv",sep=",",header=T)
df.2$id <- 1:nrow(df.2)
df.3 <- join(df,df.2,by="Gene")
df[,2] == df.3[,2]
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_cho.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
plot(log10(df[x,i]),log10(cho[x,2]),main=bquote("Sample " ~ .(i-1) ~" vs cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[x,i]),log10(cho[x,2]))
rho.s <- cor(log10(df[x,i]),log10(cho[x,2]),method="spearman")
xlim <- c(min(log10(df[x,i])),max(log10(df[x,i])))
ylim <- c(min(log10(cho[x,2])),max(log10(cho[x,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
cho <- read.table("../GSE67218/mRNA_level.csv",sep=",",header=T)
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
plot(log10(df[x,i]),log10(cho[x,2]),main=bquote("Sample " ~ .(i-1) ~" vs cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[x,i]),log10(cho[x,2]))
rho.s <- cor(log10(df[x,i]),log10(cho[x,2]),method="spearman")
xlim <- c(min(log10(df[x,i])),max(log10(df[x,i])))
ylim <- c(min(log10(cho[x,2])),max(log10(cho[x,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_cho.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
plot(log10(df[x,i]),log10(cho[x,2]),main=bquote("Sample " ~ .(i-1) ~" vs cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[x,i]),log10(cho[x,2]))
rho.s <- cor(log10(df[x,i]),log10(cho[x,2]),method="spearman")
xlim <- c(min(log10(df[x,i])),max(log10(df[x,i])))
ylim <- c(min(log10(cho[x,2])),max(log10(cho[x,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
View(cho)
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_lietal.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
y <- which(li[,2] != 0)
z <- intersect(x,y)
plot(log10(df[z,i]),log10(li[z,2]),main=bquote("Sample " ~ .(i-1) ~" vs Li et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[z,i]),log10(li[z,2]))
rho.s <- cor(log10(df[z,i]),log10(li[z,2]),method="spearman")
xlim <- c(min(log10(df[z,i])),max(log10(df[z,i])))
ylim <- c(min(log10(li[z,2])),max(log10(li[z,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Li et al data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Li et al data",xlab="Spearman correlation coefficient")
dev.off()
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_cho.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
y <- which(li[,2] != 0)
z <- intersect(x,y)
plot(log10(df[z,i]),log10(cho[z,2]),main=bquote("Sample " ~ .(i-1) ~" vs cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[z,i]),log10(cho[z,2]))
rho.s <- cor(log10(df[z,i]),log10(cho[z,2]),method="spearman")
xlim <- c(min(log10(df[z,i])),max(log10(df[z,i])))
ylim <- c(min(log10(cho[z,2])),max(log10(cho[z,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_lietal.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
y <- which(li[,2] != 0)
z <- intersect(x,y)
plot(log10(df[z,i]),log10(li[z,2]),main=bquote("Sample " ~ .(i-1) ~" vs Li et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[z,i]),log10(li[z,2]))
rho.s <- cor(log10(df[z,i]),log10(li[z,2]),method="spearman")
xlim <- c(min(log10(df[z,i])),max(log10(df[z,i])))
ylim <- c(min(log10(li[z,2])),max(log10(li[z,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Li et al data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Li et al data",xlab="Spearman correlation coefficient")
dev.off()
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_cho.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
y <- which(li[,2] != 0)
z <- intersect(x,y)
plot(log10(df[z,i]),log10(cho[z,2]),main=bquote("Sample " ~ .(i-1) ~" vs Cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[z,i]),log10(cho[z,2]))
rho.s <- cor(log10(df[z,i]),log10(cho[z,2]),method="spearman")
xlim <- c(min(log10(df[z,i])),max(log10(df[z,i])))
ylim <- c(min(log10(cho[z,2])),max(log10(cho[z,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
traceback()
pp <- c()
ps <- c()
pdf("GSE45443_comparisons_to_cho.pdf")
for (i in 2:ncol(df))
{
x <- which(df[,i]!=0)
y <- which(cho[,2] != 0)
z <- intersect(x,y)
plot(log10(df[z,i]),log10(cho[z,2]),main=bquote("Sample " ~ .(i-1) ~" vs Cho et al"),xlab="log10(mRNA Abundance)",ylab="log10(mRNA abundance)")
rho.p <- cor(log10(df[z,i]),log10(cho[z,2]))
rho.s <- cor(log10(df[z,i]),log10(cho[z,2]),method="spearman")
xlim <- c(min(log10(df[z,i])),max(log10(df[z,i])))
ylim <- c(min(log10(cho[z,2])),max(log10(cho[z,2])))
text(xlim[1]+0.5,ylim[2]-0.25,labels=bquote(rho["p"] ~ "=" ~ .(rho.p)))
text(xlim[1]+0.5,ylim[2]-0.5,labels=bquote(rho["s"] ~ "=" ~ .(rho.s)))
pp <- c(pp,rho.p)
ps <- c(ps,rho.s)
}
hist(x = pp,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Pearson correlation coefficient")
hist(x = ps,nclass = 15,main = "Accession GSE45443 with Cho data",xlab="Spearman correlation coefficient")
dev.off()
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/idk_2/emp_comp.R')
installed.packages("rtracklayer")
install.packages("rtracklayer")
setwd("~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/COLOMBOS")
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/COLOMBOS/comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/COLOMBOS/emp_comp.R')
source('~/Signal_Peptide_Project/Data/Empirical/Ecoli_K12_ncbi/COLOMBOS/emp_comp.R')
li <- read.table("../Li/mRNA_level_main_ht_liberal_low_conf_test.csv",sep=",",header=T)
li <- read.table("../Li/li_mrna_level_main_ht_liberal.csv",sep=",",header=T)
cho <- read.table("../Cho/cho_mrna_level_main_ht_liberal.csv",sep=",",header=T)
plot(log10(li[,2]),log10(cho[,2]))
li <- read.table("../Li/li_mrna_level_main_ht_liberal_low_conf_included.csv",sep=",",header=T)
plot(log10(li[,2]),log10(cho[,2]))
li <- read.table("../Li/li_mrna_level_main_ht_liberal.csv",sep=",",header=T)
x <- which(li[,2]!=0)
y <- which(cho[,2]!=0)
z <- intersect(x,y)
plot(log10(li[z,2]),log10(cho[z,2]))
cor(log10(li[z,2]),log10(cho[z,2]))
li <- read.table("../Li/li_mrna_level_main_ht_liberal_low_conf_included.csv",sep=",",header=T)
plot(log10(li[z,2]),log10(cho[z,2]))
x <- which(li[,2]!=0)
z <- intersect(x,y)
plot(log10(li[z,2]),log10(cho[z,2]))
cor(log10(li[z,2]),log10(cho[z,2]))
